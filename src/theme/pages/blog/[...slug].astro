---
import moment from 'moment'
import type { InferGetStaticPropsType } from 'astro'
import { getCollection, render } from 'astro:content'
import config from '../../consts'
import BaseLayout from '../../layouts/BaseLayout.astro'
import { slugifyBlogPostUrl } from '../../utils/slugify-blog-post-url'
import BlogPostLayout from '../../layouts/BlogPostLayout.astro'

export async function getStaticPaths() {
	const posts = await getCollection('blog')
	return posts.map((post) => ({
		params: { slug: slugifyBlogPostUrl(post.id) },
		props: post,
	}))
}

type Props = InferGetStaticPropsType<typeof getStaticPaths>
const props = Astro.props

const { Content } = await render(props)
---

<BlogPostLayout title={props.data.title} pubDate={props.data.pubDate}>
	<Content />
</BlogPostLayout>
